
<!DOCTYPE html>
<html lang="en">
<head>
  <title>First Letter Extractor with Voice Settings</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    textarea {
      width: 100%;
      height: 20vh;
      margin-bottom: 10px;
      font-size: 16px;
    }

    #output {
      height: 20vh;
      white-space: pre-wrap;
      border: 1px solid #ccc;
      padding: 20px;
      font-size: 20px;
      font-family: 'Tisa', serif;
      background-color: #f9f9f9;
      color: #333;
      margin-top: 5px;
      overflow-y: auto;
    }

    button, select, input[type="range"] {
      padding: 10px;
      font-size: 16px;
      margin-right: 10px;
      margin-top: 10px;
    }

    #copyStatus {
      margin-top: 10px;
      font-style: italic;
      color: green;
    }

    label {
      display: inline-block;
      margin-top: 10px;
    }

    body {
      background-color: #f0e6d6;
      font-family: 'Garamond', serif;
    }

    .parchment-box {
      background: linear-gradient(to bottom right, #fdf8e4, #f0e6d6);
      border: 6px double #b89b72;
      padding: 30px;
      width: 100vw;
      height: 100vh;
      box-sizing: border-box;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      font-size: 1.1rem;
      line-height: 1.6;
      color: #3b2f1c;
      border-radius: 0;
      overflow: auto;
	  
    }
	
	.parchment-box p {
	¬† margin-top: 4px;
	¬† margin-bottom: 4px;
	  margin: 4px 0;
	¬† line-height: 1.2;

	}
	
	/* Default font size */
	#inputText,
	#bibleRef,
	#output {
	¬† font-size: 16px;
	}

	/* Increase font size on small screens (like iPhones) */
	@media (max-width: 600px) {
	¬† #inputText,
	¬† #bibleRef,
	¬† #output {
	¬†¬†¬† font-size: 40px;
	¬† }
	}
	
    .button-row {
      text-align: left;
      margin-bottom: 2rem;
    }

    #outputCard {
      display: none; /* stays hidden */
      padding: 2rem;
      border: none;
      background: white;
      font-size: 1.1em;
    }

    #outputCard h1 {
      text-align: center;
      margin-bottom: 1rem;
      color: #005577;
    }

    #outputCard p {
      text-align: left;
      white-space: pre-wrap;
      line-height: 1.6;
    }


	@media print {
	  body, html {
		visibility: hidden;
		margin: 0;
		padding: 0;
		background: none !important;		
	  }
	  #outputCard, #outputCard * {
		visibility: visible;
	  }
	  #outputCard {
		position: absolute;
		top: 0;
		left: 0;
		width: 95%;
	  }

	  .parchment-box {
		background: none !important;
		border: none !important;
		padding: 0 !important;
		width: auto !important;
		height: auto !important;
		box-shadow: none !important;
		overflow: visible !important;
	  }

	  .card {
		max-width: 95% !important;
		width: 95% !important;
		margin: 0 auto !important;
		padding: 1rem !important;
		box-shadow: none !important;
		
    /* Add these for print-specific word handling */



	  }
	  
	  @page {
		margin: 0.5in;
	  }	  
	  
	}
 

    .card {
      padding: 2rem;

      max-width: 600px;
      margin: auto;
      background: #fff;
      box-shadow: none;

    }

    .card h1 {
      text-align: center;
      color: #005577;
      margin-bottom: 1rem;
    }

    .card p {
      text-align: left;
      line-height: 1.6;
      white-space: pre-wrap;
    }	
			
    #nivButton:hover + #tooltip {

      display: block;

    }

    #tooltip {
      display: none;
      position: absolute;
      top: 60px;
      left: 0;
      background-color: #fff;
      border: 1px solid #ccc;
      padding: 12px;
      width: 340px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 10;
      font-size: 12px;
	  font-family: 'Arial', san-serif;
    }

    #tooltip img {
      width: 100%;
      margin-top: 10px;
      border-radius: 4px;
    }

    .container {
      position: relative;
      display: inline-block;
    }
		
  </style>
</head>

<body>

<div class="parchment-box">

<h1>üî° First Letter Text Tool</h1>
<p>An app to help you stored up God's word in your heart.</p> 
<p>Read it, hear it, print it, memorize it and use the First Letter to make it stick..</p>
<p>Enter bible reference or paste your text below and click "Generate" to show only the first letter of each word.</p>


<label for="bibleRef">Enter Bible Reference:</label>
<input type="text" id="bibleRef" style="height: 24px;" placeholder="e.g., John 3:16">
<button onclick="fetchBibleText()">ESV</button>

  <div class="container">
    <button id="nivButton" onclick="fetchNIVBibleText()">NIV</button>
    <div id="tooltip">
      <strong>For NIV:</strong><br/>
      Enter a Bible Reference in the input box (e.g., <em>Joh 3:16</em>) and click the NIV button.<br/>
      This will open the passage in BibleGateway using the NIV translation.<br/>
	  Uncheck the Page Options as shown.<br/>
	  Copy the NIV text and paste into the "Paste your text below:" box.<br/>
      Make sure the first line is the title. Adjust/add as needed.
      <img src=gear.jpeg alt="Tooltip" />
    </div>
  </div>

<h3>Paste your text below:</h3>
<textarea id="inputText" placeholder="Type or paste text here...first line is the header or reference"></textarea>
<br>
<div class="button-row">
	<button onclick="extractFirstLetters()">Generate First Letter</button>
	<button onclick="copyBoth()">Copy Both</button>
	<button onclick="generateCard()">Generate Card</button>	
    <button onclick="printCard()">üñ®Ô∏è Print Card</button>	
</div>



<h3>Speech Settings:</h3>
<div style="display: flex; flex-wrap: wrap; align-items: center; gap: 10px;">
  <label for="voiceSelect">Voice:</label>
  <select id="voiceSelect"></select>

  <label for="pitch">Pitch:</label>
  <input type="range" id="pitch" min="0" max="2" step="0.1" value="1">

  <label for="rate">Rate:</label>
  <input type="range" id="rate" min="0.5" max="2" step="0.1" value="1">

  <button onclick="readText()">Read Input</button>
</div>

<h3>First Letter:</h3>
<div id="output"></div>
<div id="copyStatus"></div>

<div class="card" id="outputCard" style="display:none;"></div>

<footer style="font-size: 0.75em; margin-top: 2em; color: #555;">
Scripture quotations are from the ESV¬Æ Bible (The Holy Bible, English Standard Version¬Æ), ¬© 2001 by Crossway, a publishing ministry of Good News Publishers. Used by permission. All rights reserved. 
07/13/2025 Application developed by G Chu. Please send any comment and suggestion to ampelos79@gmail.com
</footer>


</div>

<script>
  let voices = [];

  function populateVoices() {
    voices = speechSynthesis.getVoices();
    const voiceSelect = document.getElementById("voiceSelect");
    voiceSelect.innerHTML = '';
    voices.forEach((voice, index) => {
      const option = document.createElement("option");
      option.value = index;
      option.textContent = `${voice.name} (${voice.lang})`;
      voiceSelect.appendChild(option);
    });
  }

  speechSynthesis.onvoiceschanged = populateVoices;

  function extractFirstLetters() {
    const text = document.getElementById("inputText").value;

    // Match Bible references like "John 3:16" or "1 Corin 12:1"
    //const bibleRefPattern = /\b(?:\d\s*)?[A-Z][a-z]+(?:\s+[A-Z][a-z]+)?\s+\d+:\d+\b/g;
    //const bibleRefs = text.match(bibleRefPattern) || [];

    // Replace Bible references with placeholders
    //let tempText = text.replace(bibleRefPattern, "<<<BIBLE_REF>>>");

    // Extract first letters from remaining text
    //let result = tempText.replace(/\b(\w)/g, "$1").replace(/\B\w+/g, "");

    // Restore Bible references
    //bibleRefs.forEach(ref => {
    //  result = result.replace("<<<BIBLE_REF>>>", ref);
    //});

	  // Split text into lines
	  const lines = text.split(/\r?\n/);

	  // Keep the first line as-is
	  const firstLine = lines[0];

	  // Process the rest of the lines
	  const processedLines = lines.slice(1).map(line =>
		line
		  .replace(/\b(\w)/g, "$1") // Keep only first letters of words
		  .replace(/\B\w+/g, "")    // Remove rest of the word
		  .replace(/\(E\)/g, "")    // Remove specific pattern
		  .replace(/\(N\)/g, '')    // Remove specific pattern
		  .replace(/\d+ */g, '')
	  );

	  // Combine first line with processed lines
	  const result = [firstLine, ...processedLines].join("\n");

	  // Clean up result
	  const cleanedResult = result
		.replace(/^\s*[\r\n]/gm, '') // Remove empty lines
		.replace(/^\s+/gm, '');      // Remove leading spaces

	
    document.getElementById("output").textContent = cleanedResult;
  }

  function copyBoth() {
    const input = document.getElementById("inputText").value;
    const output = document.getElementById("output").textContent;

    const combined = input + "\n\n" + output;

    navigator.clipboard.writeText(combined)
      .then(() => {
        document.getElementById("copyStatus").textContent = "Copied to clipboard!";
      })
      .catch(err => {
        document.getElementById("copyStatus").textContent = "Copy failed: " + err;
      });
  }

  function readText() {
    const text = document.getElementById("inputText").value;
    const pitch = parseFloat(document.getElementById("pitch").value);
    const rate = parseFloat(document.getElementById("rate").value);
    const voiceIndex = document.getElementById("voiceSelect").value;

    const utterance = new SpeechSynthesisUtterance(text);
    utterance.pitch = pitch;
    utterance.rate = rate;
    utterance.voice = voices[voiceIndex];

    speechSynthesis.speak(utterance);
  }

  function fetchBibleText() {
    const ref = document.getElementById("bibleRef").value;
    const inputBox = document.getElementById("inputText");

    fetch(`https://api.esv.org/v3/passage/text/?q=${encodeURIComponent(ref)}&include-footnotes=false&include-headings=false`, {
      headers: {
        Authorization: "Token bfc087d29a9dbacd714085aef4cb29f487d4fcf8"
      }
    })
    .then(response => response.json())
    .then(data => {
      let passage = data.passages ? data.passages.join("\n") : "Passage not found.";
      passage = passage.replace(/\(\d+\)/g, ""); // remove (99)
      passage = passage.replace(/\[\d+\]/g, ""); // remove [99]
      passage = passage.split("\n").filter(line => !/^\(\d+\)/.test(line)).join("\n"); // remove lines starting with (99)

	  passage = passage.replace(/(^\s*$\n)+/gm, "\n");
	  
	  passage = passage.replace(/\n{3,}/g, "\n"); // remove double (or more) new lines

      inputBox.value = passage;
    })
    .catch(error => {
      inputBox.value = "Error fetching passage: " + error;
    });
	
	const card = document.getElementById("outputCard");
    card.innerHTML = ``;
	
	document.getElementById("output").textContent = '';
	
  }
  
  function fetchNIVBibleText() {
	const ref = document.getElementById("bibleRef").value.trim();
	const inputBox = document.getElementById("inputText");
	  
    if (ref) {

		const encodedPassage = encodeURIComponent(ref);
		const url = `https://www.biblegateway.com/passage/?search=${encodedPassage}&version=NIV`;
        window.open(url, "_blank");
		} else {
		alert("Please enter a reference.");
    }
  }
  
    function generateCard() {
      const inputText = document.getElementById("inputText").value.trim();
      const additionalContent = document.getElementById("output").innerText.trim();
      if (!inputText) return;

      const lines = inputText.split('\n');
      const header = lines[0];
      const bodyLines = lines.slice(1).join('\n');
      const fullBody = `${bodyLines}\n\n${additionalContent}`;

      const card = document.getElementById("outputCard");
      card.innerHTML = `<h1>${header}</h1><p>${fullBody}</p>`;
	  card.style.display = 'block';

	  console.log("Print content:", card.innerHTML); // Debugging line
    }

    function printCard() { 
	  const card = document.getElementById("outputCard");	
	  card.style.display = 'block';
	  console.log("Print content:", card.innerHTML); // Debugging line	  

	  setTimeout(() => {
	    window.print();
	  }, 100);

	}
  
</script>

</body>



</html>
